"""
Unified malware scanner - automatically uses VirusTotal
"""
from src.threat_detection.virustotal_scanner import VirusTotalScanner
import os
from typing import Dict, Tuple
import streamlit as st
from src.utils.logger import logger


class MalwareScanner:
    """Unified malware scanner interface"""

    def __init__(self):
        self.scanner = VirusTotalScanner()
        logger.info("Malware scanner initialized: VirusTotal")

    def scan_file(self, file_path: str, force_scan: bool = False) -> Tuple[bool, Dict]:
        """
        Scan a file for malware

        Args:
            file_path: Path to file to scan
            force_scan: Whether to force a fresh scan

        Returns:
            (is_safe: bool, result: Dict)
        """
        logger.info(f"Scanning file: {file_path}")
        return self.scanner.scan_file(file_path, force_scan)

    def quick_scan(self, file_path: str) -> bool:
        """
        Quick scan - returns only boolean result

        Args:
            file_path: Path to file to scan

        Returns:
            True if safe, False if threat detected
        """
        is_safe, _ = self.scan_file(file_path)
        return is_safe
